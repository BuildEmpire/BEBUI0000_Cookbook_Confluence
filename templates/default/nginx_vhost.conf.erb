server {

    server_name <%= node['cookbook_confluence']['hostname'] %>;
    listen <%= node['cookbook_confluence']['listen_port'] %>;

    access_log <%= node['nginx']['log_dir'] %>/<%= node['cookbook_confluence']['appname'] %>-access.log combined;
    error_log  <%= node['nginx']['log_dir'] %>/<%= node['cookbook_confluence']['appname'] %>-error.log;
    rewrite_log on;

    client_max_body_size 40M;

    location / {
        proxy_set_header X-Forwarded-Host $host;
        proxy_set_header X-Forwarded-Server $host;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://localhost:<%= node['cookbook_confluence']['tomcat']['port'] %>;
    }

}